<div class="container">
  <mat-accordion class="headers-align">
    <mat-expansion-panel [ngStyle]="{'background-color':sessions[i].isInstructor ?  'white' : '#b2f6f8' }"
     [expanded]="step === i" (opened)="setStep(i)" hideToggle *ngFor="let session of sessions; let i = index;">
      <mat-expansion-panel-header [collapsedHeight]="'90px'" [expandedHeight]="'90px'">
        <div>
          <mat-panel-title>
            <h5 class="title"><b>{{session.title}}</b></h5>
          </mat-panel-title>
          <mat-panel-description class="instructor">
            <b>Instructor:</b>{{session.instructorName}}
          </mat-panel-description>
        </div>
        <span class="example-fill-remaining-space"></span>
        <div class="date-cap">
          <mat-panel-description class="session-date">
            <span><b>Date: </b></span>{{session.sessionDate}}
            <!-- WHEN, HOW LONG, HOW MANY-->
          </mat-panel-description>
          <mat-panel-description class="duration">
            <span><b> Duration: </b></span> {{session.duration}} min
          </mat-panel-description>
          <mat-panel-description class="capacity">
            <b>Capacity:</b>{{session.subscribedCount}}/{{session.capacity}}
          </mat-panel-description>
        </div>
        <ng-template #content let-modal let-c="close" let-d="dismiss">
          <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Survey</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="rating text-center">
            <form>
              <p class="quest">How would you rate the session's productivity?</p>
              <label for="one">Low</label>
              <input type="radio" id="one1" [(ngModel)]="productivity" name="productivity" value="1">
              <input type="radio" id="two1" [(ngModel)]="productivity" name="productivity" value="2">
              <input type="radio" id="three1" [(ngModel)]="productivity" name="productivity" value="3">
              <input type="radio" id="four1" [(ngModel)]="productivity" name="productivity" value="4">
              <input type="radio" id="five1" [(ngModel)]="productivity" name="productivity" value="5">
              <label for="five1">High</label>
            </form>
            <form>
              <p class="quest">Do you think the subject is appropriate?</p>
              <label for="one">No</label>
              <input type="radio" id="one2" [(ngModel)]="maturity" name="maturity" value="1">
              <input type="radio" id="two2" [(ngModel)]="maturity" name="maturity" value="2">
              <input type="radio" id="three2" [(ngModel)]="maturity" name="maturity" value="3">
              <input type="radio" id="four2" [(ngModel)]="maturity" name="maturity" value="4">
              <input type="radio" id="five2" [(ngModel)]="maturity" name="maturity" value="5">
              <label for="five2">Yes</label>
            </form>
            <form>
              <p class="quest">In general how would you rate the instructor's performance?</p>
              <label for="one">Bad</label>
              <input type="radio" id="on3e" [(ngModel)]="friendliness" name="friendliness" value="1">
              <input type="radio" id="two3" [(ngModel)]="friendliness" name="friendliness" value="2">
              <input type="radio" id="three3" [(ngModel)]="friendliness" name="friendliness" value="3">
              <input type="radio" id="four3" [(ngModel)]="friendliness" name="friendliness" value="4">
              <input type="radio" id="five3" [(ngModel)]="friendliness" name="friendliness" value="5">
              <label for="five3">Good</label>
            </form>
            <form>
              <p class="quest">Was the mail goal achieved?</p>
              <label for="one">No</label>
              <input type="radio" id="one4" [(ngModel)]="intelligence" name="intelligence" value="1">
              <input type="radio" id="two4" [(ngModel)]="intelligence" name="intelligence" value="2">
              <input type="radio" id="three4" [(ngModel)]="intelligence" name="intelligence" value="3">
              <input type="radio" id="four4" [(ngModel)]="intelligence" name="intelligence" value="4">
              <input type="radio" id="five4" [(ngModel)]="intelligence" name="intelligence" value="5">
              <label for="five4">Yes</label>
            </form>
          </div>
          <!-- OCCUPATION QUESTION -->
          <div class="occupation">
            <p>In your opinion what could be an improvement for future sessions?</p>
            <textarea [(ngModel)]="improvements" cols="50" rows="5"></textarea>
            <br>
            <button class="button-sub" type="button" (click)="answerQuestionnaire(i)">Submit </button>
          </div>
        </ng-template>
        <div *ngIf="questionButton">
          <button type="button" class="button-answer" (click)="open(content)">Answer</button>
        </div>
      </mat-expansion-panel-header>

      <mat-action-row *ngIf="uselessRows">
        <!-- <div class="left-aligned">
          <b>Instructor Info:</b> <br>
          {{session.instructorName}}
        </div> -->

        <div class="left-aligned">
          <div>
            <span><b>Location: </b></span>{{session.location}}
          </div>
        </div>
        <span class="example-fill-remaining-space"></span>
        <div class="center-aligned">
          <div>
            <span><b>Requirements: </b></span>{{session.requirements}}
          </div>
        </div>
      </mat-action-row>
      <mat-action-row *ngIf="uselessRows">
        <span class="example-fill-remaining-space"></span>
        <div class="left-aligned">
          <b>Description: </b> {{session.description}}
        </div>
        <span class="example-fill-remaining-space"></span>
      </mat-action-row>
      <mat-action-row class="container-fluid" *ngIf="sessions[i].isInstructor && sessions[i].subscribedCount > 0">
        <div class="row w-100">
          <div class="col-2" *ngFor="let user of session.users; let y = index">
            <span (click)="setAttendance(session.subs[y+1]['id'], i, y+1)"
              [ngStyle]="{'background-color':session.subs[y+1].attended == 'Pending' ?  'white' : (session.subs[y+1].attended == 'attended' ? 'green': 'rgb(226, 44, 44)')}"
              class="attendeesInSession btn mx-1"
              *ngIf="y + 1 < session.users.length">{{ session.users[y + 1].name }}</span>
          </div>
        </div>

      </mat-action-row>
      <mat-action-row *ngIf="uselessRows">
        <div *ngIf="!sessions[i].isInstructor && subButtons">
          <div class="btn-group btn-group-toggle" *ngIf="!sessions[i].subscribed">
            <button mat-button class="sub" [disabled]="sessions[i].capacity == sessions[i].subscribedCount"
              (click)="sub(session.id, i)">Subscribe</button>
          </div>
          <div class="btn-group btn-group-toggle" *ngIf="sessions[i].subscribed">
            <button mat-button class="unsub" (click)="unsub(i)">Unsubscribe</button>
          </div>
        </div>
        <span class="example-fill-remaining-space"></span>

        <!-- <div *ngIf="marcarFaltas">
          <span class="avisomau">
            <b>Skipped</b>
          </span>
          <span class="aviso">
            <b>Pending</b>
          </span>
          <span class="avisobom"> 
            <b>Attended</b>
          </span> 
        </div> -->

        <span class="example-fill-remaining-space"></span>
        <button mat-button class="previous" *ngIf="step != 0" (click)="prevStep()">Previous</button>
        <button mat-button class="next" *ngIf="step != sessions.length -1" (click)="nextStep()">Next</button>
      </mat-action-row>
    </mat-expansion-panel>
  </mat-accordion>
  <div class="mes" *ngIf="emptyHist">You have no sessions on track record.</div>
  <div class="mes" *ngIf="emptyQues">You have no pendent feedback to send us.</div>

</div>